<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Untitled :: The Mill Build Tool</title>
    <meta name="generator" content="Antora 3.1.9" />
    <link rel="stylesheet" href="../../../../_/css/site.css" />
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-1C582ZJR85"></script>
    <script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','G-1C582ZJR85')</script>
<link rel="icon" href="../../../../_/favicon.png" type="image/x-icon" />
  
  </head><body class="article">
  
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <!-- TODO: add mill icon -->
      <a class="navbar-item" href="https://mill-build.org"><img src="../../../../_/logo-white.svg" height="20" />Â The Mill Build Tool</a>
      <div class="navbar-item search">
        <input id="search-input" type="text" placeholder="Search the docs" />
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/com-lihaoyi/mill">Source Code (GitHub)</a>
        <a class="navbar-item" href="https://mill-build.org/api/latest/index.html">API</a>
        <a class="navbar-item" href="https://github.com/com-lihaoyi/mill/issues">Issues</a>
        <a class="navbar-item" href="https://github.com/com-lihaoyi/mill/discussions">Discuss</a>
        <a class="navbar-item" href="https://discord.gg/MNAXQMAr">Chat</a>

            <!--
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Documentation</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#"></a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Plugins</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
        -->
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="mill" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
<ul class="nav-list">

  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../Java_Intro_to_Mill.html">Building Java Projects with Mill</a>
<ul class="nav-list">

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Java_Installation_IDE_Support.html">Installation and IDE Support</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Java_Builtin_Commands.html">Built-in Commands</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Java_Module_Config.html">Java Module Configuration</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Java_Build_Examples.html">Java Build Examples</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Testing_Java_Projects.html">Testing Java Projects</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Linting_Java_Projects.html">Linting Java Projects</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Publishing_Java_Projects.html">Publishing Java Projects</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Java_Web_Examples.html">Java Web Examples</a>
  </li>
</ul>
  </li>

  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../Scala_Intro_to_Mill.html">Building Scala Projects with Mill</a>
<ul class="nav-list">

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Scala_Installation_IDE_Support.html">Installation and IDE Support</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Scala_Builtin_Commands.html">Built-in Commands</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Scala_Module_Config.html">Scala Module Configuration</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Scala_Build_Examples.html">Scala Build Examples</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Testing_Scala_Projects.html">Testing Scala Projects</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Linting_Scala_Projects.html">Linting Scala Projects</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Publishing_Scala_Projects.html">Publishing Scala Projects</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Scala_Web_Examples.html">Scala Web Examples</a>
  </li>
</ul>
  </li>

  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../Kotlin_Intro_to_Mill.html">Building Kotlin Projects with Mill</a>
<ul class="nav-list">

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Kotlin_Installation_IDE_Support.html">Installation and IDE Support</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Kotlin_Builtin_Commands.html">Built-in Commands</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Kotlin_Module_Config.html">Kotlin Module Configuration</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Kotlin_Build_Examples.html">Kotlin Build Examples</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Testing_Kotlin_Projects.html">Testing Kotlin Projects</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Linting_Kotlin_Projects.html">Linting Kotlin Projects</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Publishing_Kotlin_Projects.html">Publishing Kotlin Projects</a>
  </li>
</ul>
  </li>

  <li class="nav-item is-active" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Build Tool Comparisons</span>
<ul class="nav-list">

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Case_Study_Mill_vs_Maven.html">Case Study: Mill vs Maven</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Case_Study_Mill_vs_Gradle.html">Case Study: Mill vs Gradle</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Case_Study_Mill_vs_SBT.html">Case Study: Mill vs SBT</a>
  </li>
</ul>
  </li>

  <li class="nav-item is-active" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Mill In Depth</span>
<ul class="nav-list">

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Library_Dependencies.html">Library Dependencies in Mill</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Out_Dir.html">The Output Directory</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Target_Query_Syntax.html">Target Query Syntax</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Tasks.html">Tasks</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Modules.html">Modules</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Cross_Builds.html">Cross Builds</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Structuring_Large_Builds.html">Structuring Large Builds</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Mill_Sandboxing.html">Mill Sandboxing</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Bundled_Libraries.html">Bundled Libraries</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../The_Mill_Evaluation_Model.html">The Mill Evaluation Model</a>
  </li>
</ul>
  </li>

  <li class="nav-item is-active" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Extending Mill</span>
<ul class="nav-list">

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Import_File_And_Import_Ivy.html">import $file and import $ivy</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Using_Plugins.html">Using Plugins</a>
  </li>

  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../Contrib_Plugins.html">Contrib Plugins</a>
<ul class="nav-list">

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../contrib/artifactory.html">Artifactory</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../contrib/bintray.html">Bintray</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../contrib/bloop.html">Bloop</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../contrib/buildinfo.html">BuildInfo</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../contrib/codeartifact.html">Codeartifact</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../contrib/docker.html">Docker</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../contrib/errorprone.html">Mill ErrorProne Plugin</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../contrib/checkstyle.html">Checkstyle</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../contrib/flyway.html">Flyway</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../contrib/gitlab.html">Gitlab</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../contrib/jmh.html">JMH</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../contrib/playlib.html">Play Framework</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../contrib/proguard.html">Proguard</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../contrib/scalapblib.html">ScalaPB</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../contrib/scoverage.html">Scoverage</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../contrib/sonatypecentral.html">Sonatype Central</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../contrib/testng.html">TestNG</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../contrib/twirllib.html">Twirl</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../contrib/versionfile.html">Version file</a>
  </li>
</ul>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Thirdparty_Plugins.html">Third-Party Plugins</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Writing_Mill_Plugins.html">Writing Mill Plugins</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../The_Mill_Meta_Build.html">The Mill Meta-Build</a>
  </li>
</ul>
  </li>

  <li class="nav-item is-active" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Reference</span>
<ul class="nav-list">

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Mill_Design_Principles.html">Mill Design Principles</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://mill-build.org/api/latest/mill/index.html">Mill Scaladoc</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Changelog.html">Changelog</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../0.11.12/Java_Intro_to_Mill.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">0.12.0-RC2-37-0a9d3b</button>
  <div class="version-menu">
    <a class="version is-current" href="7-resources.html">0.12.0-RC2-37-0a9d3b</a>
    <a class="version is-missing" href="../../../0.11.12/index.html">0.11.12</a>
    <a class="version is-missing" href="../../../0.11.11/index.html">0.11.11</a>
    <a class="version is-missing" href="../../../0.11.10/index.html">0.11.10</a>
    <a class="version is-missing" href="../../../0.11.0-M7/index.html">0.11.0-M7</a>
    <a class="version is-missing" href="../../../0.10.15/index.html">0.10.15</a>
    <a class="version is-missing" href="../../../0.10.12/index.html">0.10.12</a>
    <a class="version is-missing" href="../../../0.10.0/index.html">0.10.0</a>
    <a class="version is-missing" href="../../../0.9.12/index.html">0.9.12</a>
  </div>
</div>
<div class="edit-this-page"><a href="https://github.com/com-lihaoyi/mill/edit/main/docs/modules/ROOT/pages/example/kotlinlib/module/7-resources.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<div class="listingblock">
<div class="title">build.mill (<a href="https://github.com/com-lihaoyi/mill/releases/download/0.12.0-RC2/0.12.0-RC2-example-kotlinlib-module-7-resources.zip">download</a>, <a href="https://github.com/com-lihaoyi/mill/blob/0.12.0-RC2//example/kotlinlib/module/7-resources">browse</a>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">package build
import mill._, kotlinlib._

object foo extends KotlinModule {

  def kotlinVersion = &quot;1.9.24&quot;

  object test extends KotlinModuleTests with TestModule.Junit5 {
    def otherFiles = T.source(millSourcePath / &quot;other-files&quot;)

    def forkEnv = super.forkEnv() ++ Map(
      &quot;OTHER_FILES_FOLDER&quot; -&gt; otherFiles().path.toString
    )

    def ivyDeps = super.ivyDeps() ++ Agg(
      ivy&quot;io.kotest:kotest-runner-junit5-jvm:5.9.1&quot;
    )
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; ./mill foo.test
... foo.FooTests...simple ...
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>This section discusses how tests can depend on resources locally on disk.
Mill provides two ways to do this: via the JVM classpath resources, and via
the resource folder which is made available as the environment variable
<code>MILL_TEST_RESOURCE_FOLDER</code>;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <strong>classpath resources</strong> are useful when you want to fetch individual files,
and are bundled with the application by the <code>.assembly</code> step when constructing
an assembly jar for deployment. But they do not allow you to list folders
or perform other filesystem operations.</p>
</li>
<li>
<p>The <strong>resource folder</strong>, available via <code>MILL_TEST_RESOURCE_FOLDER</code>, gives you
access to the folder path of the resources on disk. This is useful in allowing
you to list and otherwise manipulate the filesystem, which you cannot do with
<strong>classpath resources</strong>. However, the <code>MILL_TEST_RESOURCE_FOLDER</code> only exists
when running tests using Mill, and is not available when executing applications
packaged for deployment via <code>.assembly</code></p>
</li>
<li>
<p>Apart from <code>resources/</code>, you can provide additional folders to your test suite
by defining a <code>Task.Source</code> (<code>otherFiles</code> above) and passing it to <code>forkEnv</code>. This
provide the folder path as an environment variable that the test can make use of</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example application code demonstrating the techniques above can be seen below:</p>
</div>
<div class="listingblock">
<div class="title">foo/test/resources/test-file-a.txt (<a href="https://github.com/com-lihaoyi/mill/blob/0.12.0-RC2//example/kotlinlib/module/7-resources/foo/test/resources/test-file-a.txt">browse</a>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">Test Hello World Resource File A</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">foo/test/resources/test-file-b.txt (<a href="https://github.com/com-lihaoyi/mill/blob/0.12.0-RC2//example/kotlinlib/module/7-resources/foo/test/resources/test-file-b.txt">browse</a>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">Test Hello World Resource File B</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">foo/test/other-files/other-file.txt (<a href="https://github.com/com-lihaoyi/mill/blob/0.12.0-RC2//example/kotlinlib/module/7-resources/foo/test/other-files/other-file.txt">browse</a>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">Other Hello World File</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">foo/src/Foo.kt (<a href="https://github.com/com-lihaoyi/mill/blob/0.12.0-RC2//example/kotlinlib/module/7-resources/foo/src/Foo.kt">browse</a>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">package foo

import java.io.IOException
import java.io.InputStream

object Foo {

    // Read `file.txt` from classpath
    fun classpathResourceText(): String {
        // Get the resource as an InputStream
        return Foo::class.java.classLoader.getResourceAsStream(&quot;file.txt&quot;).use {
            it.readAllBytes().toString(Charsets.UTF_8)
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">foo/test/src/FooTests.kt (<a href="https://github.com/com-lihaoyi/mill/blob/0.12.0-RC2//example/kotlinlib/module/7-resources/foo/test/src/FooTests.kt">browse</a>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">package foo

import io.kotest.core.spec.style.FunSpec
import io.kotest.matchers.shouldBe

import java.io.InputStream
import java.io.IOException
import java.nio.file.Files
import java.nio.file.Paths
import java.nio.file.Path
import java.util.List
import java.util.ArrayList

class FooTests : FunSpec({

    test(&quot;simple&quot;) {
        // Reference app module's `Foo` class which reads `file.txt` from classpath
        val appClasspathResourceText = Foo.classpathResourceText()
        appClasspathResourceText shouldBe &quot;Hello World Resource File&quot;

        // Read `test-file-a.txt` from classpath
        val testClasspathResourceText = Foo::class.java.classLoader.getResourceAsStream(&quot;test-file-a.txt&quot;).use {
            it.readAllBytes().toString(Charsets.UTF_8)
        }
        testClasspathResourceText shouldBe &quot;Test Hello World Resource File A&quot;

        // Use `MILL_TEST_RESOURCE_FOLDER` to read `test-file-b.txt` from filesystem
        val testFileResourceDir = Paths.get(System.getenv(&quot;MILL_TEST_RESOURCE_FOLDER&quot;))
        val testFileResourceText = Files.readString(
            testFileResourceDir.resolve(&quot;test-file-b.txt&quot;)
        )
        testFileResourceText shouldBe &quot;Test Hello World Resource File B&quot;

        // Use `MILL_TEST_RESOURCE_FOLDER` to list files available in resource folder
        val actualFiles = Files.list(testFileResourceDir).toList().sorted()
        val expectedFiles = listOf(
            testFileResourceDir.resolve(&quot;test-file-a.txt&quot;),
            testFileResourceDir.resolve(&quot;test-file-b.txt&quot;)
        )
        actualFiles shouldBe expectedFiles

        // Use the `OTHER_FILES_FOLDER` configured in your build to access the
        // files in `foo/test/other-files/`.
        val otherFileText = Files.readString(
            Paths.get(System.getenv(&quot;OTHER_FILES_FOLDER&quot;), &quot;other-file.txt&quot;)
        )
        otherFileText shouldBe &quot;Other Hello World File&quot;
    }
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that tests require that you pass in any files that they depend on explicitly.
This is necessary so that Mill knows when a test needs to be re-run and when a
previous result can be cached. This also ensures that tests reading and writing
to the current working directory do not accidentally interfere with each others
files, especially when running in parallel.</p>
</div>
<div class="paragraph">
<p>The test process runs in a <code>sandbox/</code> folder, not in your project root folder, to
prevent you from accidentally accessing files without explicitly passing them. If
you have legacy tests that need to run in the project root folder to work, you
can configure your test suite with <code>def testSandboxWorkingDir = false</code> to disable
the sandbox and make the tests run in the project root.</p>
</div>
</article>
  </div>
</main>
</div>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>
<script async="async" src="../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../.." data-snippet-length="100" data-stylesheet="../../../../_/css/search.css"></script>
<script async="async" src="../../../../search-index.js"></script>
  
</body></html>