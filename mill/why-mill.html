<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Why Mill? :: The Mill JVM Build Tool</title>
    <link rel="prev" href="kotlinlib/android-examples.html" />
    <link rel="next" href="comparisons/maven.html" />
    <meta name="generator" content="Antora 3.1.9" />
    <link rel="stylesheet" href="../_/css/site.css" />
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-1C582ZJR85"></script>
    <script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','G-1C582ZJR85')</script>
<link rel="icon" href="../_/favicon.png" type="image/x-icon" />
  
  </head><body class="article">
  
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <!-- TODO: add mill icon -->
      <a class="navbar-item" href="https://mill-build.org"><img src="../_/logo-white.svg" height="20" />Â The Mill JVM Build Tool</a>
      <div class="navbar-item search">
        <input id="search-input" type="text" placeholder="Search the docs" />
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/com-lihaoyi/mill">Source Code (GitHub)</a>
        <a class="navbar-item" href="https://mill-build.org/api/latest/index.html">API</a>
        <a class="navbar-item" href="https://github.com/com-lihaoyi/mill/issues">Issues</a>
        <a class="navbar-item" href="https://github.com/com-lihaoyi/mill/discussions">Discuss</a>


            <!--
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Documentation</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#"></a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Plugins</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
        -->
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="mill" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
<ul class="nav-list">

  <li class="nav-item" data-depth="0">
<ul class="nav-list">

  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="javalib/intro.html">Building Java with Mill</a>
<ul class="nav-list">

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="javalib/builtin-commands.html">Built-in Commands</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="javalib/module-config.html">Java Module Configuration</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="javalib/dependencies.html">Java Library Dependencies</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="javalib/testing.html">Testing Java Projects</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="javalib/linting.html">Linting Java Projects</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="javalib/publishing.html">Publishing Java Projects</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="javalib/build-examples.html">Java Build Examples</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="javalib/web-examples.html">Java Web Project Examples</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="javalib/android-examples.html">(Experimental) Android Builds</a>
  </li>
</ul>
  </li>

  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="scalalib/intro.html">Building Scala with Mill</a>
<ul class="nav-list">

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="scalalib/builtin-commands.html">Built-in Commands</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="scalalib/module-config.html">Scala Module Configuration</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="scalalib/dependencies.html">Scala Library Dependencies</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="scalalib/testing.html">Testing Scala Projects</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="scalalib/linting.html">Linting Scala Projects</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="scalalib/publishing.html">Publishing Scala Projects</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="scalalib/build-examples.html">Scala Build Examples</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="scalalib/web-examples.html">Scala Web Project Examples</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="scalalib/native-examples.html">Scala Native Examples</a>
  </li>
</ul>
  </li>

  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="kotlinlib/intro.html">(Experimental) Kotlin with Mill</a>
<ul class="nav-list">

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="kotlinlib/builtin-commands.html">Built-in Commands</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="kotlinlib/module-config.html">Kotlin Module Configuration</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="kotlinlib/dependencies.html">Kotlin Library Dependencies</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="kotlinlib/testing.html">Testing Kotlin Projects</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="kotlinlib/linting.html">Linting Kotlin Projects</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="kotlinlib/publishing.html">Publishing Kotlin Projects</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="kotlinlib/web-examples.html">Kotlin Web Project Examples</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="kotlinlib/android-examples.html">(Experimental) Android Builds</a>
  </li>
</ul>
  </li>

  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="why-mill.html">Why Mill?</a>
<ul class="nav-list">

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="comparisons/maven.html">Case Study: Mill vs Maven</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="comparisons/gradle.html">Case Study: Mill vs Gradle</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="comparisons/sbt.html">Case Study: Mill vs SBT</a>
  </li>
</ul>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">The Mill CLI</span>
<ul class="nav-list">

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="cli/installation-ide.html">Installation &amp; IDE Support</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="cli/flags.html">Mill Command-Line Flags</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="cli/alternate-installation.html">Other installation methods</a>
  </li>
</ul>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Mill Fundamentals</span>
<ul class="nav-list">

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="fundamentals/tasks.html">Tasks</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="fundamentals/modules.html">Modules</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="fundamentals/out-dir.html">The Output Directory</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="fundamentals/query-syntax.html">Task Query Syntax</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="fundamentals/library-deps.html">Library Dependencies in Mill</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="fundamentals/cross-builds.html">Cross Builds</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="fundamentals/bundled-libraries.html">Bundled Libraries</a>
  </li>
</ul>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Extending Mill</span>
<ul class="nav-list">

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="extending/import-ivy-plugins.html">Import Libraries and Plugins</a>
  </li>

  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="extending/contrib-plugins.html">Contrib Plugins</a>
<ul class="nav-list">

  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="contrib/artifactory.html">Artifactory</a>
  </li>

  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="contrib/bintray.html">Bintray</a>
  </li>

  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="contrib/bloop.html">Bloop</a>
  </li>

  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="contrib/buildinfo.html">BuildInfo</a>
  </li>

  <li class="nav-item is-active" data-depth="3">
    <a class="nav-link" href="contrib/codeartifact.html">Codeartifact</a>
  </li>

  <li class="nav-item is-active" data-depth="3">
    <a class="nav-link" href="contrib/docker.html">Docker</a>
  </li>

  <li class="nav-item is-active" data-depth="3">
    <a class="nav-link" href="contrib/flyway.html">Flyway</a>
  </li>

  <li class="nav-item is-active" data-depth="3">
    <a class="nav-link" href="contrib/gitlab.html">Gitlab</a>
  </li>

  <li class="nav-item is-active" data-depth="3">
    <a class="nav-link" href="contrib/jmh.html">JMH</a>
  </li>

  <li class="nav-item is-active" data-depth="3">
    <a class="nav-link" href="contrib/playlib.html">Play Framework</a>
  </li>

  <li class="nav-item is-active" data-depth="3">
    <a class="nav-link" href="contrib/proguard.html">Proguard</a>
  </li>

  <li class="nav-item is-active" data-depth="3">
    <a class="nav-link" href="contrib/scalapblib.html">ScalaPB</a>
  </li>

  <li class="nav-item is-active" data-depth="3">
    <a class="nav-link" href="contrib/scoverage.html">Scoverage</a>
  </li>

  <li class="nav-item is-active" data-depth="3">
    <a class="nav-link" href="contrib/sonatypecentral.html">Sonatype Central</a>
  </li>

  <li class="nav-item is-active" data-depth="3">
    <a class="nav-link" href="contrib/testng.html">TestNG</a>
  </li>

  <li class="nav-item is-active" data-depth="3">
    <a class="nav-link" href="contrib/twirllib.html">Twirl</a>
  </li>

  <li class="nav-item is-active" data-depth="3">
    <a class="nav-link" href="contrib/versionfile.html">Version file</a>
  </li>
</ul>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="extending/thirdparty-plugins.html">Third-Party Plugins</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="extending/running-jvm-code.html">Running Dynamic JVM Code</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="extending/writing-plugins.html">Writing Mill Plugins</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="extending/meta-build.html">The Mill Meta-Build</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="extending/new-language.html">Support for New Languages</a>
  </li>
</ul>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Mill In Depth</span>
<ul class="nav-list">

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="depth/large-builds.html">Large Builds and Monorepos</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="depth/sandboxing.html">Mill Sandboxing</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="depth/evaluation-model.html">The Mill Evaluation Model</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="depth/design-principles.html">Mill Design Principles</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="depth/why-scala.html">Why does Mill use Scala?</a>
  </li>
</ul>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Reference</span>
<ul class="nav-list">

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://mill-build.org/api/latest/mill/index.html">Mill Scaladoc</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="reference/changelog.html">Changelog</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Mill Documentation</span>
    <span class="version">0.12.1-21-45c296</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="0.12.1/index.html">Mill Documentation</a></div>
      <ul class="versions">
        <li class="version is-current">
          <a href="index.html">0.12.1-21-45c296</a>
        </li>
        <li class="version is-latest">
          <a href="0.12.1/index.html">0.12.1</a>
        </li>
        <li class="version">
          <a href="0.11.12/index.html">0.11.12</a>
        </li>
        <li class="version">
          <a href="0.10.15/index.html">0.10.15</a>
        </li>
        <li class="version">
          <a href="0.9.12/index.html">0.9.12</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="0.12.1/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Mill Documentation</a></li>
    <li><a href="why-mill.html">Why Mill?</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="https://github.com/com-lihaoyi/mill/edit/main/docs/modules/ROOT/pages/why-mill.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Why Mill?</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Mill is a fast build tool for Java, Scala, and Kotlin. Although the Java
compiler is very fast and the Java language is easy to learn, JVM build tools are
known to be slow and hard to use. Mill tries to offer a better alternative: 2-10x faster
than Maven or Gradle, better IDE support, and extensibility without needing plugins.
This results in time savings due to less time waiting for your build tool, as well as less
time struggling with your build tool, and more time to focus on the actual work you need to do.</p>
</div>
<div class="paragraph">
<p>At a first glance, Mill looks like any other build tool. You have build files, you configure
dependencies, you can compile, run, or test your project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">// build.mill
package build
import mill._, javalib._

object foo extends JavaModule {
  def ivyDeps = Agg(
    ivy&quot;net.sourceforge.argparse4j:argparse4j:0.9.0&quot;,
    ivy&quot;org.thymeleaf:thymeleaf:3.1.1.RELEASE&quot;
  )

  object test extends JavaTests with TestModule.Junit4
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; /mill foo.compile
compiling 1 Java source...

&gt; /mill foo.run --text hello
&lt;h1&gt;hello&lt;/h1&gt;

&gt; ./mill foo.test
Test foo.FooTest.testEscaping finished, ...
Test foo.FooTest.testSimple finished, ...
0 failed, 0 ignored, 2 total, ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Beyond the basics, Mill provides 3 major advantages over other build tools. The comparison pages
for the respective build tool go into more detail (for <a href="comparisons/maven.html" class="xref page">Maven</a>,
<a href="comparisons/gradle.html" class="xref page">Gradle</a>, and <a href="comparisons/sbt.html" class="xref page">SBT</a>), but at a high level
these advantages are:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Performance</strong>: Mill offers a 2-10x speedup means less time waiting for your build tool,
meaning less time waiting for your build and more time doing useful work</p>
</li>
<li>
<p><strong>Ease of Use</strong>: Mill has better IDE support in IntelliJ and VSCode and richer
visualization tools that other tools, to help understand your build and what it is doing</p>
</li>
<li>
<p><strong>Extensibility</strong>: Mill lets you write code or use any published JVM library in your build,
customizing it to your needs without being limited by third-party plugins</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>We will discuss each one in turn.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_performance"><a class="anchor" href="#_performance"></a>Performance</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_maven"><a class="anchor" href="#_maven"></a>Maven</h3>
<div class="paragraph">
<p>Overall across our benchmarks, Mill is 5-10x faster than Maven for clean compiles,
both parallel and sequential, and for many modules or for a single module:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;" />
<col style="width: 25%;" />
<col style="width: 25%;" />
<col style="width: 25%;" />
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Benchmark</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maven</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mill</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Speedup</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="comparisons/maven.html#_sequential_clean_compile_all" class="xref page">Sequential Clean Compile All</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2m 31.12s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0m 22.19s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.8x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="comparisons/maven.html#_parallel_clean_compile_all" class="xref page">Parallel Clean Compile All</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1m 16.45s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0m 09.95s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.7x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="comparisons/maven.html#_clean_compile_single_module" class="xref page">Clean Compile Single Module</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0m 19.62s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0m 02.17s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.0x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="comparisons/maven.html#_incremental_compile_single_module" class="xref page">Incremental Compile Single Module</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0m 21.10s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0m 00.54s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">39.1x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="comparisons/maven.html#_no_op_compile_single_module" class="xref page">No-Op Compile Single Module</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0m 17.34s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0m 00.47s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">36.9x</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For the purposes of this page, we will focus on two benchmarks</p>
</div>
<div class="sect3">
<h4 id="_parallel_clean_compile_all"><a class="anchor" href="#_parallel_clean_compile_all"></a>Parallel Clean Compile All</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;" />
<col style="width: 25%;" />
<col style="width: 25%;" />
<col style="width: 25%;" />
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Benchmark</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maven</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mill</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Speedup</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="comparisons/maven.html#_parallel_clean_compile_all" class="xref page">Parallel Clean Compile All</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1m 16.45s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0m 09.95s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.7x</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; time ./mvnw -T 10 -DskipTests  -Dcheckstyle.skip -Denforcer.skip=true clean install

&gt; ./mill clean; time ./mill __.compile</code></pre>
</div>
</div>
<div class="paragraph">
<p>This benchmark involves running <code>clean</code> to delete all generated files and re-compiling
everything in parallel.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For Maven, parallelism is opt-in via <code>-T 10</code>, while for Mill it is enabled by default.</p>
</li>
<li>
<p>For Maven, tests and linters are opt-out via the <code>-D</code> properties, while in Mill
tests an linters are opt-in</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Mill sees a significant ~8x speedup over Maven for this benchmark.</p>
</div>
</div>
<div class="sect3">
<h4 id="_incremental_compile_single_module"><a class="anchor" href="#_incremental_compile_single_module"></a>Incremental Compile Single-Module</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;" />
<col style="width: 25%;" />
<col style="width: 25%;" />
<col style="width: 25%;" />
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Benchmark</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maven</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mill</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Speedup</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="comparisons/maven.html#_incremental_compile_single_module" class="xref page">Incremental Compile Single Module</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0m 21.10s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0m 00.54s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">39.1x</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ echo &quot;&quot; &gt;&gt; common/src/main/java/io/netty/util/AbstractConstant.java
$ time ./mvnw -pl common -DskipTests  -Dcheckstyle.skip -Denforcer.skip=true install
Compiling 174 source files to /Users/lihaoyi/Github/netty/common/target/classes
Compiling 60 source files to /Users/lihaoyi/Github/netty/common/target/test-classes


$ echo &quot;&quot; &gt;&gt; common/src/main/java/io/netty/util/AbstractConstant.java
$ time ./mill common.test.compile
compiling 1 Java source to /Users/lihaoyi/Github/netty/out/common/compile.dest/classes ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>This benchmark involves making a single edit to a single already-compiled file in <code>common</code> -
adding a single newline to the end of the file - and re-compiling <code>common</code> and <code>common.test</code>.</p>
</div>
<div class="paragraph">
<p>Mill sees a huge ~39x speedup for this benchmark, because Millâs incremental compiler
(<a href="https://github.com/sbt/zinc">Zinc</a>) is able to detect that only one file in one module
has changed, and that the change is small enough
to not require other files to re-compile. In contrast, Maven re-compiles all files in both
modules, even though only one file was touched and the change was trivial.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_gradle"><a class="anchor" href="#_gradle"></a>Gradle</h3>
<div class="paragraph">
<p>The comparison with Gradle is less stark, but still significant. Mill is 3-4x faster than Gradle
across the various workflows:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;" />
<col style="width: 25%;" />
<col style="width: 25%;" />
<col style="width: 25%;" />
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Benchmark</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gradle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mill</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Speedup</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="comparisons/maven.html#_sequential_clean_compile_all" class="xref page">Sequential Clean Compile All</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">17.6s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.40s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.3x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="comparisons/maven.html#_parallel_clean_compile_all" class="xref page">Parallel Clean Compile All</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12.3s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.57s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.4x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="comparisons/maven.html#_clean_compile_single_module" class="xref page">Clean Compile Single Module</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.41s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.20s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.7x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="comparisons/maven.html#_incremental_compile_single_module" class="xref page">Incremental Compile Single Module</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.37s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.51s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.7x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="comparisons/maven.html#_no_op_compile_single_module" class="xref page">No-Op Compile Single Module</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.94s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.46s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.0x</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Again, for the purposes of this page, we will focus on two benchmarks</p>
</div>
<div class="sect3">
<h4 id="_parallel_clean_compile_all_2"><a class="anchor" href="#_parallel_clean_compile_all_2"></a>Parallel Clean Compile All</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;" />
<col style="width: 25%;" />
<col style="width: 25%;" />
<col style="width: 25%;" />
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Benchmark</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gradle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mill</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Speedup</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="comparisons/maven.html#_parallel_clean_compile_all" class="xref page">Parallel Clean Compile All</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12.3s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.57s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.4x</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ./gradlew clean; time ./gradlew classes testClasses --no-build-cache

$ ./mill clean; time ./mill __.compile</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here we only run compilation for classes and test classes, without linting or testing or anything else.
Both Mill and Gradle are parallel by default, with 1 thread per core. For Gradle we disabled the global
build cache to ensure we can benchmark the actual compilation time.</p>
</div>
<div class="paragraph">
<p>We measure Mill being ~3.4x faster than Gradle for this benchmark.</p>
</div>
</div>
<div class="sect3">
<h4 id="_incremental_compile_single_module_2"><a class="anchor" href="#_incremental_compile_single_module_2"></a>Incremental Compile Single-Module</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;" />
<col style="width: 25%;" />
<col style="width: 25%;" />
<col style="width: 25%;" />
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Benchmark</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gradle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mill</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Speedup</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="comparisons/maven.html#_incremental_compile_single_module" class="xref page">Incremental Compile Single Module</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.37s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.51s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.7x</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ echo &quot;&quot; &gt;&gt; src/main/java/org/mockito/BDDMockito.java; time ./gradlew :classes

$ echo &quot;&quot; &gt;&gt; src/main/java/org/mockito/BDDMockito.java; time ./mill compile
compiling 1 Java source to /Users/lihaoyi/Github/netty/out/common/compile.dest/classes ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again, this benchmark involves making a single edit to a single already-compiled file in the
root module - adding a single newline to the end of the file - and re-compiling it along with
its tests.</p>
</div>
<div class="paragraph">
<p>Both Gradle and Mill appear to do a good job limiting the compilation to only the changed
file, but Mill has less fixed overhead than Gradle does, finishing in about ~0.5s
rather than ~1.5 seconds.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ease_of_use"><a class="anchor" href="#_ease_of_use"></a>Ease of Use</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The second area that Mill does well compared to tools like Maven or Gradle is in its ease
of use.This is not just in superficial things like the build file or command-line syntax,
but also in how Mill exposes how your build works and what your build is doing so you can
understand it and confidently make changes. We will consider three cases: the Mill Chrome
Profile, Mill Visualize, and Millâs IDE support</p>
</div>
<div class="sect2">
<h3 id="_chrome_profiles"><a class="anchor" href="#_chrome_profiles"></a>Chrome Profiles</h3>
<div class="paragraph">
<p>All Mill runs generate some debugging metadata files in <code>out/mill-*</code>. One of these
is <code>out/mill-chrome-profile.json</code>, which is a file following the Chrome Profiling format.
It can be loaded into any Chrome browserâs built in <code>chrome://tracing</code> UI, to let you
interactively explore what Mill was doing during its last run. e.g. when performing a
clean compile on the Netty codebase, the profile ends up looking like this:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/comparisons/NettyCompileProfile.png" alt="NettyCompileProfile" />
</div>
</div>
<div class="paragraph">
<p>The Chrome profile shows what task each Mill thread was executing throughout the run.
The Chrome profiling UI is interactive, so you can zoom in and out, or click on individual
tasks to show the exact duration and other metadata.</p>
</div>
<div class="paragraph">
<p>But the real benefit of the Chrome profile isnât the low-level data it provides, but the
high-level view:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the profile above, it is clear that for the first ~700ms, Mill is able
to use all cores on 10 cores on my laptop to do useful work.</p>
</li>
<li>
<p>But after that, utilization is
much more sparse: <code>common.compile</code>, <code>buffer.compile</code>, <code>transport.compile</code>, <code>codec.compile</code>,
appear to wait for one another and run sequentially one after another.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This waiting is likely due to dependencies between them, and they take long enough that all
the other tasks depending on them get held up. For example, when <code>codec.compile</code> finishes
above, we can see a number of downstream tasks immediately start running.</p>
</div>
<div class="paragraph">
<p>This understanding of your buildâs performance profile is not just an academic exercise, but
provides actionable information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If I wanted faster Netty clean compiles, speeding up <code>common.compile</code>, <code>buffer.compile</code>,
<code>transport.compile</code>, or <code>codec.compile</code> would make the most impact.</p>
</li>
<li>
<p>On the other hand, time speeding up the various <code>codec-*.compile</code> tasks would help not at all:
these tasks are already running at a time where the CPUs are mostly idle.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Most build tools do provide some way of analyzing build performance, but none of them provide
it as easily as Mill does: any Mill run generates a profile automatically, and any computer
with Chrome on it is able to load and let you explore that profile. That is a powerful tool to
help engineers understand what the build is doing: any engineer who felt a build was slow
can trivially load it into their Chrome browser to analyze and figure out what.</p>
</div>
</div>
<div class="sect2">
<h3 id="_mill_visualize"><a class="anchor" href="#_mill_visualize"></a>Mill Visualize</h3>
<div class="paragraph">
<p>Apart from the Mill Chrome Profile, Mill also provides the <code>./mill visualize</code> command, which
is useful to show the logical dependency graph between tasks. For example, we can use
<code>./mill visualize <em>.compile</em></code> (double <code></code> means wildcard) to
show the dependency graph between the modules of the Netty build below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/comparisons/NettyCompileGraph.svg" alt="NettyCompileGraph" />
</div>
</div>
<div class="paragraph">
<p>(<em>Right-click open-image-in-new-tab to see full size</em>)</p>
</div>
<div class="paragraph">
<p>In this graph, we can clearly see that <code>common.compile</code>, <code>buffer.compile</code>,<code>transport.compile</code>,
and <code>codec.compile</code> depend on each other in a linear fashion. This explains why they each must
wait for the prior task to complete before starting, and cannot run in parallel with one another.
Furthermore, we can again confirm that many of the <code>codec-*.compile</code> tasks depend on <code>codec.compile</code>,
which is in the profile why we saw them waiting for the upstream task to complete before starting.</p>
</div>
<div class="paragraph">
<p>Although these are things we could have <em>guessed</em> from looking at the Chrome Profile above,
<code>./mill visualize</code> gives you a separate angle from which to look at your build. Together these
tools can help give greater understanding of what your build is doing and why it is doing that:
something that can be hard to come by with build tools that are often considered confusing and
inscrutable.</p>
</div>
</div>
<div class="sect2">
<h3 id="_ide_support"><a class="anchor" href="#_ide_support"></a>IDE Support</h3>
<div class="paragraph">
<p>One area that Mill does better than Gradle is providing a seamless IDE experience. For example,
consider the snippet below where we are using Gradle to configure the javac compiler options.
Due to <code>.gradle</code> files being untyped Groovy, the autocomplete and code-assist experience working
with these files is hit-or-miss. In the example below, we can see that IntelliJ is able to identify
that <code>compileArgs</code> exists and has the type <code>List&lt;String&gt;</code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/comparisons/IntellijMockitoGradleCompileOptions.png" alt="IntellijMockitoGradleCompileOptions" />
</div>
</div>
<div class="paragraph">
<p>But if you try to jump to definition or find out anything else about it you hit a wall:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/comparisons/IntellijMockitoGradleCompileOptions2.png" alt="IntellijMockitoGradleCompileOptions2" />
</div>
</div>
<div class="paragraph">
<p>Often working with build configurations feels like hitting dead ends: if you donât have
<code>options.compilerArgs</code> memorized in your head, there is literally nothing you can do in your editor to
make progress to figure out what it is or what it is used for. That leaves you googling
for answers, which can be a frustrating experience that distracts you from the task at hand.</p>
</div>
<div class="paragraph">
<p>The fundamental problem with tools like Gradle is that the code you write does not
actually perform the build: rather, you are just setting up some data structure that
is used to configure the <em>real</em> build engine that runs later. Thus when you explore
the Gradle build in an IDE, the IDE can only explore the configuration logic (which
is usually un-interesting) and is unable to explore the actual build logic (which
is what you actually care about!)</p>
</div>
<div class="paragraph">
<p>In comparison, Millâs <code>.mill</code> files are all statically typed, and as a result IntelliJ is easily able to
pull up the documentation for <code>def javacOptions</code>, even though it doesnât have any special support
for Mill built into the IDE:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/comparisons/IntellijMockitoMillJavacOptionsDocs.png" alt="IntellijMockitoMillJavacOptionsDocs" />
</div>
</div>
<div class="paragraph">
<p>Apart from static typing, the way Mill builds are structured also helps the IDE: Mill
code <em>actually performs your build</em>, rather than configuring some opaque build engine.
While that sounds academic, one concrete consequence is that IntelliJ is able to take
your <code>def javacOptions</code> override and
find the original definitions that were overridden, and show you where they are defined:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/comparisons/IntellijMockitoMillJavacOptionsParents.png" alt="IntellijMockitoMillJavacOptionsParents" />
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/comparisons/IntellijMockitoMillJavacOptionsDef.png" alt="IntellijMockitoMillJavacOptionsDef" />
</div>
</div>
<div class="paragraph">
<p>Furthermore, because task dependencies in Mill are just normal method calls, IntelliJ is
able to <em>find usages</em>, showing you where the task is used. Below, we can see the method
call in the <code>def compile</code> task, which uses <code>javacOptions()</code> along with a number of other tasks:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/comparisons/IntellijMockitoMillCompile.png" alt="IntellijMockitoMillCompile" />
</div>
</div>
<div class="paragraph">
<p>From there, if you are curious about any of the other tasks used alongside <code>javacOptions</code>, itâs
easy for you to pull up <em>their</em> documentation, jump to <em>their</em>
definition, or find <em>their</em> usages. For example we can pull up the docs of</p>
</div>
<div class="paragraph">
<p><code>compileClasspath()</code> below, jump to <em>its</em> implementation, and continue
interactively exploring your build logic:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/comparisons/IntellijMockitoMillCompileClasspath.png" alt="IntellijMockitoMillCompileClasspath" />
</div>
</div>
<div class="paragraph">
<p>Unlike most other build tools, Mill builds can be explored interactively in your
IDE. If you do not know what something does, itâs documentation, definition, or usages is always
one click away in IntelliJ or VSCode. This isnât a new experience for Java developers, as it
is what you would be used to day-to-day in your application code! But Mill brings that same
polished experience to your build system - traditionally some that that has been opaque
and hard to understand - and does so in a way that no other build tool does.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_extensibility"><a class="anchor" href="#_extensibility"></a>Extensibility</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Mill allows you to directly write code to configure your build, and even download libraries
from Maven Central.</p>
</div>
<div class="paragraph">
<p>Most build tools need plugins to do anything: if you want to Foo you need a
Foo plugin, if you want to Bar you need a Bar plugin, for any possible Foo or Bar. These could
be simple tasks - zipping up files, pre-rendering web templates, preparing static assets for
deployment - but even a tasks that would be trivial to implement in a few lines of code requires
you to Google for third-party plugins, dig through their Github to see which one is best
maintained, and hope for the best when you include it in your build. And while you could
write plugins yourself, doing so is usually challenging and non-trivial.</p>
</div>
<div class="paragraph">
<p>Mill is different. Although it does have plugins for more advanced integrations, for most
simple things you can directly write code to achieve what you want, using the bundled
filesystem, subprocess, and dependency-management libraries. And even if you need third-party
libraries from Maven Central to do Foo, you can directly import the &quot;Foo&quot; library and use it
directly, without having to find a &quot;Foo build plugin&quot; wrapper.</p>
</div>
<div class="sect2">
<h3 id="_simple_custom_tasks"><a class="anchor" href="#_simple_custom_tasks"></a>Simple Custom Tasks</h3>
<div class="paragraph">
<p>The following Mill build is a minimal Java module <code>foo</code>. It contains no custom configuration, and
so inherits all the defaults from <code>mill.javalib.JavaModule</code>: default source folder layout, default
assembly configuration, default compiler flags, and so on.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">package build
import mill._, javalib._

object foo extends JavaModule {
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; mill compile
Compiling 1 Java source...</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to add a custom task, this is as simple as defining a method e.g.
<code>def lineCount = Task { â¦â }</code>. The body of <code>Task</code> performs the action we want, and
can depend on other tasks such as <code>allSourceFiles()</code> below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">package build
import mill._, javalib._

object foo extends JavaModule {
  /** Total number of lines in module source files */
  def lineCount = Task {
    allSourceFiles().map(f =&gt; os.read.lines(f.path).size).sum
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once we define a new task, we can immediately begin using it in our build.
<code>lineCount</code> is not used by any existing <code>JavaModule</code> tasks, but we can still
show its value via the Mill command line to force it to evaluate:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; mill show foo.lineCount
17</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_overriding_tasks"><a class="anchor" href="#_overriding_tasks"></a>Overriding Tasks</h3>
<div class="paragraph">
<p>To wire up <code>lineCount</code> into our main <code>JavaModule</code> <code>compile</code>/<code>test</code>/<code>run</code> tasks,
one way is to take the line count value and write it to a file in <code>def resources</code>.
This file can then be read at runtime as a JVM resource. We do that below
by overriding <code>def resources</code> and making it depend on <code>lineCount</code>, in addition
to its existing value <code>super.resources()</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">package build
import mill._, javalib._

object foo extends JavaModule {
  /** Total number of lines in module source files */
  def lineCount = Task {
    allSourceFiles().map(f =&gt; os.read.lines(f.path).size).sum
  }

  /** Generate resources using lineCount of sources */
  override def resources = Task {
    os.write(Task.dest / &quot;line-count.txt&quot;, &quot;&quot; + lineCount())
    super.resources() ++ Seq(PathRef(Task.dest))
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because <code>override def resources</code> overrides the existing <code>resources</code> method used
in the rest of <code>JavaModule</code>, the downstream tasks automatically now use the new
override instead, as that is how overrides work. That means if you call <code>mill foo.run</code>,
it will automatically pick up the new <code>line-count.txt</code> file and make it available to
the application code to use e.g. below, where we just print it out:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; mill foo.run
Line Count: 17</code></pre>
</div>
</div>
<div class="paragraph">
<p>Most developers do not need to embed the line-count of their codebase in a resource
file to look up at runtime, but nevertheless this example shows how easy it is to write
code to perform ad-hoc tasks without needing to pull in and configure some third-party
plugin. And we get full IDE support with autocomplete/navigation/documentation/etc.
while we are writing our custom task.</p>
</div>
<div class="paragraph">
<p>While most build tools do allow writing and wiring up custom tasks, none of them
have a workflow as simple as Mill. Next, weâll look at a more realistic example,
which includes usage of third-party libraries in the build.</p>
</div>
</div>
<div class="sect2">
<h3 id="_using_libraries_from_maven_central_in_tasks"><a class="anchor" href="#_using_libraries_from_maven_central_in_tasks"></a>Using Libraries from Maven Central in Tasks</h3>
<div class="paragraph">
<p>Earlier on we discussed possibly pre-rendering HTML pages in the build so they can be
served at runtime. The use case for this are obvious: if a page never changes, rendering
it on every request is wasteful, and even rendering it once and then caching it can impact
your application startup time. Thus, you may want to move some HTML rendering to build-time,
but with traditional build tools such a move is sufficiently inconvenient and complicated
that people do not do it.</p>
</div>
<div class="paragraph">
<p>With Mill, pre-rendering HTML at build time is really easy, even if you need a third-party
library. Mill does not ship with a bundled HTML templating engine, but you can use the
<code>import $ivy</code> syntax to include one such as Thymeleaf, which would immediately make the
Thymeleaf classes available for you to import and use in your build as below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">package build
import mill._, javalib._
import $ivy.`org.thymeleaf:thymeleaf:3.1.1.RELEASE`
import org.thymeleaf.TemplateEngine
import org.thymeleaf.context.Context
object foo extends JavaModule {
  def htmlSnippet = Task {
    val context = new Context()
    context.setVariable(&quot;heading&quot;, &quot;hello&quot;)
    new TemplateEngine().process(
        &quot;&lt;h1 th:text=\&quot;${heading}\&quot;&gt;&lt;/h1&gt;&quot;,
        context
    )
  }
  def resources = Task.Sources{
    os.write(Task.dest / &quot;snippet.txt&quot;, htmlSnippet())
    super.resources() ++ Seq(PathRef(Task.dest))
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once we have run <code>import $ivy</code>, we can import <code>TemplateEngine</code>, <code>Context</code>, and replace our
<code>def lineCount</code> with a <code>def htmlSnippet</code> task that uses Thymeleaf to render  HTML. Again,
we get full IDE support for working with the Thymeleaf Java API, the new <code>htmlSnippet</code> task
is inspectable from the Mill command line via <code>show</code>, and we wire it up into
<code>def resources</code> so it can be inspected and used at runtime by the application
(in this case just printed out):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; mill show foo.htmlSnippet
&quot;&lt;h1&gt;hello&lt;/h1&gt;&quot;

&gt; mill foo.compile
compiling 1 Java source...
...

&gt; mill foo.run
generated snippet.txt resource: &lt;h1&gt;hello&lt;/h1&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Rendering HTML using the Thymeleaf templating engine is not rocket science, but what is
interesting here is what we did <em>not</em> need to do:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We did <em>not</em> need to find a Thymeleaf-Mill plugin in order to include Thymeleaf in our
build</p>
</li>
<li>
<p>We did <em>not</em> need to learn a special API or framework for authoring build plugins ourselves
to write a plugin to include Thymeleaf in our build</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Instead, we could simply import Thymeleaf directly from Maven Central and use it just
like we would use it in any Java application, complete with full IDE support for
autocomplete and code navigation, with the same experience you probably are already
used to for your application code. This makes it an order of magnitude easier for
non-experts to configure their build to do exactly what they need, rather than be
limited by what some unmaintained third-party plugin might support. And although
the configuration is done in the Scala language, the syntax should be relatively
familiar (&quot;Java without Semicolons&quot; it is sometimes called) and the JVM libraries
and tools (e.g. Thymeleaf, IntelliJ, VSCode) are the exact same libraries and tools
you are already used to.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion"><a class="anchor" href="#_conclusion"></a>Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To wrap up, Mill does all the same things that other build tools like Maven or Gradle do,
but aims to do them better: faster, easier to use, and easier to extend.
This means both time saved waiting for your build tool to run in day-to-day work, as well
as time saved when you inevitably need to evolve or adjust your build system to accommodate
changing requirements.</p>
</div>
<div class="paragraph">
<p>With Mill, you can therefore spend less time waiting for or fighting with your build tool,
and more time on the actual work you are trying to accomplish. And while traditionally build
systems were often mysterious black boxes that only experts could work with, Millâs ease
of use and ease of extension democratize the build system so any developer can figure out
what its doing or extend it to do exactly what they need.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="kotlinlib/android-examples.html">(Experimental) Android Builds</a></span>
  <span class="next"><a href="comparisons/maven.html">Case Study: Mill vs Maven</a></span>
</nav>
</article>
  </div>
</main>
</div>
<script id="site-script" src="../_/js/site.js" data-ui-root-path="../_"></script>
<script async="async" src="../_/js/vendor/highlight.js"></script>
<script src="../_/js/vendor/lunr.js"></script>
<script src="../_/js/search-ui.js" id="search-ui-script" data-site-root-path=".." data-snippet-length="100" data-stylesheet="../_/css/search.css"></script>
<script async="async" src="../search-index.js"></script>
  
</body></html>